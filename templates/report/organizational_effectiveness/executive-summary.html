<!-- templates/report/organizational_effectiveness/executive-summary.html -->
<section class="w-full bg-white px-10 py-8 space-y-6 report-section">

  <!-- í—¤ë” ë¸”ë¡ - ì¼ê´€ì„± ë³´ì¥ -->
  <header class="flex items-center justify-between gap-4">
    <div>
      <h1 class="text-xl font-semibold text-slate-900 mt-1">
        ì¡°ì§ íš¨ê³¼ì„± í•µì‹¬ ì§„ë‹¨ ê²°ê³¼
      </h1>
      <p class="text-sm text-slate-500 mt-1">
        {{ report.organization_name or report.org_name or "ì—…ë¡œë“œ ë°ì´í„°" }}
      </p>
    </div>
    <div class="text-xs text-slate-400">
      {% if report.report_date %}{{ report.report_date }}{% endif %}
    </div>
  </header>

  <!-- ì•ˆì „í•œ AI ê°ì²´ ì¶”ì¶œ -->
  {% set ai = ai_result or (report.summary.ai if report.summary is defined and report.summary.ai is defined else {}) %}

  <!-- 1. ì§„ë‹¨ ëª¨ë¸ ì†Œê°œ -->
  <section class="space-y-4">
    <h2 class="text-base font-semibold text-slate-900">ì§„ë‹¨ ëª¨ë¸ ì†Œê°œ</h2>


    <!-- ì„¤ëª… í…ìŠ¤íŠ¸ -->
    <div class="rounded-xl border border-slate-100 bg-slate-50/60 px-4 py-4 text-sm leading-relaxed text-slate-700">
      ì…ë ¥(Input)â€“ê³¼ì •(Process)â€“ì‚°ì¶œ(Output)ë¡œ ì´ì–´ì§€ëŠ” IPO í”„ë ˆì„ê³¼ SKMS ìš´ì˜ ì›ì¹™ì„ ê²°í•©í•´
      ì¡°ì§ì˜ ìì› íˆ¬ì…, ì‹¤í–‰ í”„ë¡œì„¸ìŠ¤, ê²°ê³¼ ë° êµ¬ì„±ì› ê²½í—˜ì„ í•œ ë²ˆì— ì§„ë‹¨í•˜ë„ë¡ ì„¤ê³„
    </div>

    <!-- IPO ì˜ì—­ë³„ ìƒì„¸ ì„¤ëª… -->
    <div class="grid grid-cols-3 gap-3">
      <!-- Input ì„¤ëª… -->
      <div class="rounded-lg border border-blue-100 bg-blue-50/50 px-3 py-3">
        <div class="flex items-center gap-2 mb-2">
          <div class="w-6 h-6 rounded bg-blue-100 flex items-center justify-center">
            <span class="text-blue-600 text-xs font-bold">I</span>
          </div>
          <h3 class="text-sm font-semibold text-blue-700">Input (íˆ¬ì…)</h3>
        </div>
        <p class="text-xs text-slate-600 leading-relaxed">
          ì¡°ì§ì´ ì„±ê³¼ë¥¼ ì°½ì¶œí•˜ê¸° ìœ„í•´ íˆ¬ì…í•˜ëŠ” ìì›ê³¼ ì—­ëŸ‰ì„ í‰ê°€í•©ë‹ˆë‹¤.
          ì „ëµì˜ ëª…í™•ì„±, ì¡°ì§êµ¬ì¡°ì˜ ì ì •ì„±, ì—­í• ê³¼ ì±…ì„ì˜ ì •ì˜ ìˆ˜ì¤€ì„ í™•ì¸í•©ë‹ˆë‹¤.
        </p>
      </div>

      <!-- Process ì„¤ëª… -->
      <div class="rounded-lg border border-emerald-100 bg-emerald-50/50 px-3 py-3">
        <div class="flex items-center gap-2 mb-2">
          <div class="w-6 h-6 rounded bg-emerald-100 flex items-center justify-center">
            <span class="text-emerald-600 text-xs font-bold">P</span>
          </div>
          <h3 class="text-sm font-semibold text-emerald-700">Process (ê³¼ì •)</h3>
        </div>
        <p class="text-xs text-slate-600 leading-relaxed">
          íˆ¬ì…ëœ ìì›ì´ ì„±ê³¼ë¡œ ì „í™˜ë˜ëŠ” ì‹¤í–‰ ê³¼ì •ì„ ì§„ë‹¨í•©ë‹ˆë‹¤.
          ë¦¬ë”ì‹­ ë°œíœ˜, íŒ€ í˜‘ì—…, ì˜ì‚¬ì†Œí†µ, ì—…ë¬´ í”„ë¡œì„¸ìŠ¤ì˜ íš¨ìœ¨ì„±ì„ ì¸¡ì •í•©ë‹ˆë‹¤.
        </p>
      </div>

      <!-- Output ì„¤ëª… -->
      <div class="rounded-lg border border-orange-100 bg-orange-50/50 px-3 py-3">
        <div class="flex items-center gap-2 mb-2">
          <div class="w-6 h-6 rounded bg-orange-100 flex items-center justify-center">
            <span class="text-orange-600 text-xs font-bold">O</span>
          </div>
          <h3 class="text-sm font-semibold text-orange-700">Output (ì‚°ì¶œ)</h3>
        </div>
        <p class="text-xs text-slate-600 leading-relaxed">
          ì¡°ì§ì´ ë‹¬ì„±í•œ ê²°ê³¼ì™€ êµ¬ì„±ì›ì˜ ê²½í—˜ì„ ì¢…í•©ì ìœ¼ë¡œ í‰ê°€í•©ë‹ˆë‹¤.
          ì„±ê³¼ ë‹¬ì„±, êµ¬ì„±ì› ëª°ì…, ì¡°ì§ë¬¸í™”, ì§€ì†ê°€ëŠ¥ì„±ì„ ì¸¡ì •í•©ë‹ˆë‹¤.
        </p>
      </div>
    </div>

  </section>

  <!-- 2. ì¡°ì§ ë§¥ë½ ë¶„ì„ -->
  <section class="space-y-3">
    <h2 class="text-base font-semibold text-slate-900">ì¡°ì§ ë§¥ë½ ë¶„ì„</h2>
    <div class="rounded-xl border border-slate-100 bg-slate-50/60 px-4 py-4 min-h-[110px] text-sm leading-relaxed text-slate-700">
      {% if ai and ("org_context" in ai) and ai["org_context"] %}
        {{ ai["org_context"] }}
      {% else %}
        ì‘ë‹µ ì¡°ì§ì˜ ì»¨í…ìŠ¤íŠ¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € 'AI í•´ì„ ìƒì„±í•˜ê¸°'ë¥¼ ì‹¤í–‰í•´ ì£¼ì„¸ìš”.
      {% endif %}
    </div>
  </section>

  <!-- 3. IPO ì˜ì—­ë³„ ì¡°ì§íš¨ê³¼ì„± ì ìˆ˜ (ê°€ë¡œë°°ì¹˜, PDF ì•ˆì „) -->
  <section class="space-y-4 mt-6">
    <h2 class="text-base font-semibold text-slate-900">IPO ì˜ì—­ë³„ ë¶„ì„</h2>

    {% set ipo_cards = report.summary.ipo_cards if report.summary is defined and report.summary.ipo_cards is defined else [] %}

    {% if ipo_cards %}
      <div class="ipo-score-row" style="display:flex; gap:1rem; align-items:stretch; page-break-inside:avoid; break-inside:avoid;">
        {% for card in ipo_cards %}
          {% set cid = (card.id or card.title or '').lower() %}
          {% if 'input' in cid %}
            {% set bg = 'background:linear-gradient(160deg,#e3ecff 0%,#ffffff 35%);border-left:4px solid #0f4fa8;' %}
          {% elif 'process' in cid %}
            {% set bg = 'background:linear-gradient(160deg,#e6fff5 0%,#ffffff 35%);border-left:4px solid #10b981;' %}
          {% else %}
            {% set bg = 'background:linear-gradient(160deg,#fff2e6 0%,#ffffff 35%);border-left:4px solid #f97316;' %}
          {% endif %}
          <div
            class="ipo-score-card rounded-xl px-6 py-4"
            style="flex:1 1 0; display:flex; flex-direction:column; justify-content:space-between; {{ bg }} page-break-inside:avoid; break-inside:avoid;"
          >
            <div>
              <p class="text-[0.65rem] font-semibold tracking-wide text-slate-500 uppercase">{{ card.title }}</p>
              <p class="mt-2 text-3xl font-semibold text-slate-900">
                {{ "%.1f"|format(card.score) if card.score is not none else "-" }}
              </p>
            </div>
            <p class="mt-3 text-[0.68rem] text-slate-600 leading-snug">
              {{ card.desc }}
            </p>
          </div>
        {% endfor %}
      </div>

      <!-- IPO + SKMS ê´€ì ì—ì„œì˜ í•´ì„ (IPO ì¹´ë“œ ë°”ë¡œ ì•„ë˜ì— í†µí•©) -->
      <div class="mt-4 rounded-xl border border-slate-100 bg-white px-5 py-4 min-h-[110px] text-sm leading-relaxed text-slate-700">
        <div class="flex items-center gap-2 mb-3">
          <div class="w-5 h-5 rounded bg-blue-100 flex items-center justify-center">
            <span class="text-blue-600 text-xs font-bold">ğŸ“Š</span>
          </div>
          <h3 class="text-sm font-semibold text-slate-800">IPO + SKMS ê´€ì ì—ì„œì˜ í•´ì„</h3>
        </div>
        <div class="text-sm leading-relaxed text-slate-700">
          {% if ai and ("score" in ai) and ai["score"] %}
            {{ ai["score"] }}
          {% else %}
            IPO ê´€ì ì˜ í•µì‹¬ í•´ì„ì´ ì•„ì§ ìƒì„±ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤. 'AI í•´ì„ ìƒì„±í•˜ê¸°'ë¥¼ ë¨¼ì € ì‹¤í–‰í•´ ì£¼ì„¸ìš”.
          {% endif %}
        </div>
      </div>
    {% else %}
      <p class="text-xs text-slate-400">IPO ì¹´ë“œ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
    {% endif %}
  </section>

  <!-- í˜ì´ì§€ ë¸Œë ˆì´í¬ ì „ ì§„ë‹¨ ì¢…í•© ë¶„ì„ -->
  <div style="page-break-before: auto; break-before: auto; margin-top: 2rem;"></div>

  <!-- 4. ì§„ë‹¨ ì¢…í•© ë¶„ì„ (ê°•ì¡°ëœ ê²°ë¡  ì„¹ì…˜) -->
  <section class="space-y-4 mt-8" style="page-break-inside: avoid; break-inside: avoid;">
    <!-- ê°•ì¡°ëœ í—¤ë” -->
    <div class="relative">
      <div class="absolute inset-0 bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 rounded-2xl opacity-10"></div>
      <div class="relative bg-white rounded-2xl border-2 border-gradient-to-r from-blue-200 to-purple-200 px-6 py-4">
        <div class="flex items-center gap-3 mb-2">
          <div class="w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center">
            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </div>
          <div>
            <h2 class="text-lg font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
              ì§„ë‹¨ ì¢…í•© ë¶„ì„
            </h2>
          </div>
        </div>

        <!-- ê°•ì¡°ëœ ì½˜í…ì¸  ë°•ìŠ¤ -->
        <div class="bg-gradient-to-br from-slate-50 to-blue-50 rounded-xl border border-slate-200 p-6 mt-4 shadow-inner">
          <div class="text-sm leading-relaxed text-slate-800">
            {% if ai and ("writer" in ai) and ai["writer"] %}
              <div class="prose prose-sm prose-slate max-w-none">
                <div class="whitespace-pre-line font-medium">
                  {{ ai["writer"] }}
                </div>
              </div>
            {% else %}
              <div class="text-center py-8">
                <div class="w-16 h-16 mx-auto rounded-full bg-blue-100 flex items-center justify-center mb-4">
                  <svg class="w-8 h-8 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                  </svg>
                </div>
                <h3 class="font-semibold text-slate-900 mb-2">AI ì¢…í•© ë¶„ì„ì´ í•„ìš”í•©ë‹ˆë‹¤</h3>
                <p class="text-sm text-slate-600 mb-4">
                  ë” ê¹Šì´ ìˆëŠ” ì„ì›ìš© ì¸ì‚¬ì´íŠ¸ë¥¼ ìœ„í•´ 'AI í•´ì„ ìƒì„±í•˜ê¸°' ê¸°ëŠ¥ì„ ë¨¼ì € ì‹¤í–‰í•´ ì£¼ì„¸ìš”.
                </p>
                <div class="inline-flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-700 text-xs rounded-lg border border-blue-200">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                  <span>AI í•´ì„ì€ ë¦¬í¬íŠ¸ ë¯¸ë¦¬ë³´ê¸° í˜ì´ì§€ì—ì„œ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</span>
                </div>
              </div>
            {% endif %}
          </div>
        </div>

      </div>
    </div>
  </section>

</section>

<footer class="report-page-footer">
  <span class="page-number"></span>
</footer>