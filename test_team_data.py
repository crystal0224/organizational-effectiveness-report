"""
íŒ€ë³„ ë¶„ì„ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ìƒ˜í”Œ ë°ì´í„° ìƒì„± ìŠ¤í¬ë¦½íŠ¸
"""

import pandas as pd
import numpy as np
import random
from datetime import datetime

# íŒ€ ì´ë¦„ê³¼ ê° íŒ€ì˜ ì¸ì› ìˆ˜
teams = {
    "ë§ˆì¼€íŒ…íŒ€": 15,
    "ê°œë°œíŒ€": 20,
    "ì˜ì—…íŒ€": 18,
    "ê¸°íšíŒ€": 12,
    "ë””ìì¸íŒ€": 10
}

# ì¡°ì§íš¨ê³¼ì„± ì„¤ë¬¸ í•­ëª© (ì‹¤ì œ index_v2.csv ê¸°ë°˜)
survey_questions = {
    # IPO_I (Input)
    "HR1": "ìš°ë¦¬ ì¡°ì§ì€ ì¸ì¬ë¥¼ ì ê·¹ì ìœ¼ë¡œ ìœ ì¹˜í•˜ê³  ìˆë‹¤",
    "HR2": "ìš°ë¦¬ ì¡°ì§ì˜ ë³´ìƒ ì²´ê³„ëŠ” ê³µì •í•˜ë‹¤",
    "HR3": "ìš°ë¦¬ ì¡°ì§ì€ êµ¬ì„±ì›ì˜ ì„±ì¥ì„ ì§€ì›í•œë‹¤",
    "HR4": "ìš°ë¦¬ ì¡°ì§ì˜ ì¸ì‚¬ í‰ê°€ëŠ” ê°ê´€ì ì´ë‹¤",
    "HR5": "ìš°ë¦¬ ì¡°ì§ì€ ì¼ê³¼ ì‚¶ì˜ ê· í˜•ì„ ì¤‘ì‹œí•œë‹¤",

    # IPO_P (Process)
    "STG1": "ìš°ë¦¬ ì¡°ì§ì˜ ì „ëµ ë°©í–¥ì€ ëª…í™•í•˜ë‹¤",
    "STG2": "ìš°ë¦¬ ì¡°ì§ì€ ë³€í™”ì— ìœ ì—°í•˜ê²Œ ëŒ€ì‘í•œë‹¤",
    "STG3": "ìš°ë¦¬ ì¡°ì§ì€ í˜ì‹ ì„ ì¥ë ¤í•œë‹¤",
    "OP1": "ìš°ë¦¬ ì¡°ì§ì˜ ì—…ë¬´ í”„ë¡œì„¸ìŠ¤ëŠ” íš¨ìœ¨ì ì´ë‹¤",
    "OP2": "ìš°ë¦¬ ì¡°ì§ì€ ë¶€ì„œê°„ í˜‘ì—…ì´ ì›í™œí•˜ë‹¤",

    # IPO_O (Output)
    "OE1": "ìš°ë¦¬ ì¡°ì§ì€ ëª©í‘œë¥¼ ë‹¬ì„±í•˜ê³  ìˆë‹¤",
    "OE2": "ìš°ë¦¬ ì¡°ì§ì˜ ìƒì‚°ì„±ì€ ë†’ë‹¤",
    "OE3": "ìš°ë¦¬ ì¡°ì§ì˜ í’ˆì§ˆ ìˆ˜ì¤€ì€ ìš°ìˆ˜í•˜ë‹¤",
    "OE4": "ìš°ë¦¬ ì¡°ì§ì€ ê³ ê° ë§Œì¡±ë„ê°€ ë†’ë‹¤",
    "OE5": "ìš°ë¦¬ ì¡°ì§ì˜ ì„±ê³¼ëŠ” ì§€ì†ì ìœ¼ë¡œ í–¥ìƒë˜ê³  ìˆë‹¤",

    # ì¸êµ¬í†µê³„í•™ì  ì •ë³´
    "GENDER": "ì„±ë³„",
    "AGE": "ë‚˜ì´",
    "DEPT": "ë¶€ì„œ"
}

# ì£¼ê´€ì‹ ì‘ë‹µ ìƒ˜í”Œ
open_responses = {
    "ë§ˆì¼€íŒ…íŒ€": [
        "íŒ€ ë‚´ ì†Œí†µì´ ì›í™œí•˜ê³  ì°½ì˜ì ì¸ ì•„ì´ë””ì–´ë¥¼ ì¡´ì¤‘í•˜ëŠ” ë¬¸í™”ê°€ ì¢‹ìŠµë‹ˆë‹¤.",
        "í”„ë¡œì íŠ¸ ê´€ë¦¬ ë„êµ¬ë¥¼ ë” ì²´ê³„ì ìœ¼ë¡œ í™œìš©í–ˆìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.",
        "ê³ ê° í”¼ë“œë°±ì„ ë” ë¹ ë¥´ê²Œ ë°˜ì˜í•  ìˆ˜ ìˆëŠ” ì‹œìŠ¤í…œì´ í•„ìš”í•©ë‹ˆë‹¤."
    ],
    "ê°œë°œíŒ€": [
        "ê¸°ìˆ  ìŠ¤íƒ ì—…ë°ì´íŠ¸ì™€ êµìœ¡ ê¸°íšŒê°€ ë§ì•„ì„œ ì¢‹ìŠµë‹ˆë‹¤.",
        "ì½”ë“œ ë¦¬ë·° í”„ë¡œì„¸ìŠ¤ê°€ ê°œì„ ë˜ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.",
        "ê°œë°œ í™˜ê²½ê³¼ ì¸í”„ë¼ ì§€ì›ì´ í›Œë¥­í•©ë‹ˆë‹¤."
    ],
    "ì˜ì—…íŒ€": [
        "ëª©í‘œ ë‹¬ì„±ì— ëŒ€í•œ ë³´ìƒì´ ëª…í™•í•´ì„œ ë™ê¸°ë¶€ì—¬ê°€ ë©ë‹ˆë‹¤.",
        "CRM ì‹œìŠ¤í…œ ê°œì„ ì´ í•„ìš”í•©ë‹ˆë‹¤.",
        "íŒ€ì›Œí¬ê°€ ì¢‹ê³  ì„œë¡œ ë„ìš°ëŠ” ë¬¸í™”ê°€ ì˜ í˜•ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤."
    ],
    "ê¸°íšíŒ€": [
        "ì „ëµì  ì‚¬ê³ ì™€ ì¥ê¸°ì  ê´€ì ì„ ì¤‘ì‹œí•˜ëŠ” ë¬¸í™”ê°€ ì¢‹ìŠµë‹ˆë‹¤.",
        "ë¶€ì„œê°„ í˜‘ì—… í”„ë¡œì„¸ìŠ¤ê°€ ë” ì²´ê³„í™”ë˜ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.",
        "ì˜ì‚¬ê²°ì • ê³¼ì •ì´ íˆ¬ëª…í•˜ê³  í•©ë¦¬ì ì…ë‹ˆë‹¤."
    ],
    "ë””ìì¸íŒ€": [
        "ì°½ì˜ì„±ì„ ì¡´ì¤‘í•˜ê³  ì‹¤í—˜ì ì¸ ì‹œë„ë¥¼ ì¥ë ¤í•©ë‹ˆë‹¤.",
        "ë””ìì¸ ë¦¬ì†ŒìŠ¤ì™€ íˆ´ ì§€ì›ì´ ê°œì„ ë˜ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.",
        "íŒ€ì›ë“¤ì˜ ì „ë¬¸ì„±ì´ ë†’ê³  ì„œë¡œ ë°°ìš¸ ì ì´ ë§ìŠµë‹ˆë‹¤."
    ]
}

def generate_team_data():
    """íŒ€ë³„ ìƒ˜í”Œ ë°ì´í„° ìƒì„±"""
    all_data = []

    for team_name, team_size in teams.items():
        for i in range(team_size):
            row = {}

            # ì‘ë‹µì ID
            row["ID"] = f"{team_name[:2]}_{i+1:03d}"

            # íŒ€/ë¶€ì„œ ì •ë³´
            row["DEPT"] = team_name

            # ì¸êµ¬í†µê³„í•™ì  ì •ë³´
            row["GENDER"] = random.choice(["ë‚¨", "ì—¬"])
            row["AGE"] = random.choice(["20ëŒ€", "30ëŒ€", "40ëŒ€", "50ëŒ€"])

            # íŒ€ë³„ íŠ¹ì„±ì— ë”°ë¥¸ ì‘ë‹µ ìƒì„± (íŒ€ë³„ë¡œ ë‹¤ë¥¸ ê²½í–¥ì„±)
            if team_name == "ë§ˆì¼€íŒ…íŒ€":
                base_score = 3.8  # ë§ˆì¼€íŒ…íŒ€ì€ ì „ë°˜ì ìœ¼ë¡œ ê¸ì •ì 
            elif team_name == "ê°œë°œíŒ€":
                base_score = 3.5  # ê°œë°œíŒ€ì€ ì¤‘ê°„ ì •ë„
            elif team_name == "ì˜ì—…íŒ€":
                base_score = 4.0  # ì˜ì—…íŒ€ì€ ê°€ì¥ ê¸ì •ì 
            elif team_name == "ê¸°íšíŒ€":
                base_score = 3.6  # ê¸°íšíŒ€ì€ ì¤‘ê°„ ì´ìƒ
            else:  # ë””ìì¸íŒ€
                base_score = 3.7  # ë””ìì¸íŒ€ì€ ì¤‘ê°„ ì´ìƒ

            # ì„¤ë¬¸ ì‘ë‹µ (1-5 ë¦¬ì»¤íŠ¸ ì²™ë„)
            for q_code in ["HR1", "HR2", "HR3", "HR4", "HR5",
                          "STG1", "STG2", "STG3", "OP1", "OP2",
                          "OE1", "OE2", "OE3", "OE4", "OE5"]:
                # íŒ€ë³„ base_scoreë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ë³€ë™ì„± ì¶”ê°€
                score = max(1, min(5, int(np.random.normal(base_score, 0.8))))
                row[q_code] = score

            # ì£¼ê´€ì‹ ì‘ë‹µ (íŒ€ë³„ë¡œ 2-3ê°œ ëœë¤ ì„ íƒ)
            team_responses = open_responses[team_name]
            selected_responses = random.sample(team_responses, min(2, len(team_responses)))
            row["OPEN_Q1"] = selected_responses[0] if len(selected_responses) > 0 else ""
            row["OPEN_Q2"] = selected_responses[1] if len(selected_responses) > 1 else ""

            all_data.append(row)

    # DataFrame ìƒì„±
    df = pd.DataFrame(all_data)

    # ì»¬ëŸ¼ ìˆœì„œ ì •ë¦¬
    column_order = ["ID", "DEPT", "GENDER", "AGE"] + \
                   ["HR1", "HR2", "HR3", "HR4", "HR5"] + \
                   ["STG1", "STG2", "STG3", "OP1", "OP2"] + \
                   ["OE1", "OE2", "OE3", "OE4", "OE5"] + \
                   ["OPEN_Q1", "OPEN_Q2"]

    df = df[column_order]

    return df

if __name__ == "__main__":
    # ìƒ˜í”Œ ë°ì´í„° ìƒì„±
    sample_df = generate_team_data()

    # CSV íŒŒì¼ë¡œ ì €ì¥
    output_file = "team_sample_data.csv"
    sample_df.to_csv(output_file, index=False, encoding='utf-8-sig')

    print(f"âœ… íŒ€ë³„ ë¶„ì„ìš© ìƒ˜í”Œ ë°ì´í„° ìƒì„± ì™„ë£Œ!")
    print(f"ğŸ“„ íŒŒì¼ëª…: {output_file}")
    print(f"ğŸ“Š ì „ì²´ ì‘ë‹µì ìˆ˜: {len(sample_df)}ëª…")
    print(f"ğŸ¢ íŒ€ êµ¬ì„±:")
    for team, count in teams.items():
        print(f"   - {team}: {count}ëª…")
    print("\nğŸ“‹ ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°:")
    print(sample_df.head())
    print("\nğŸ“ˆ íŒ€ë³„ í‰ê·  ì ìˆ˜:")
    for team in teams.keys():
        team_data = sample_df[sample_df["DEPT"] == team]
        score_cols = [col for col in sample_df.columns if col.startswith(('HR', 'STG', 'OP', 'OE'))]
        avg_score = team_data[score_cols].mean().mean()
        print(f"   - {team}: {avg_score:.2f}")